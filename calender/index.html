<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blazinik â€” Designer & Programmer</title>
    <!-- New Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%233B82F6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'><rect x='3' y='4' width='18' height='18' rx='2' ry='2'></rect><line x1='16' y1='2' x2='16' y2='6'></line><line x1='8' y1='2' x2='8' y2='6'></line><line x1='3' y1='10' x2='21' y2='10'></line></svg>">
    <!-- Corrected Tailwind CSS CDN Link -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #020406;
            --bg-secondary: #080a0f;
            --bg-surface: #1e293b;
            --card: rgba(15, 18, 25, 0.8);
            --border: rgba(255, 255, 255, 0.08);
            --indigo: #6366f1;
            --sky: #0ea5e9;
            --rose: #f43f5e;
        }

        body {
            background-color: var(--bg-primary);
            color: #f1f5f9;
            overflow-x: hidden;
            font-family: 'Inter', sans-serif;
            letter-spacing: -0.01em;
        }

        .vignette {
            position: fixed;
            inset: 0;
            pointer-events: none;
            background: radial-gradient(circle, transparent 30%, rgba(0,0,0,0.8) 160%);
            z-index: 100;
        }

        .glass-card {
            background: rgba(12, 17, 23, 0.7);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        /* --- MERCURY NAME SHIMMER --- */
        .name-container {
            position: relative;
            display: inline-block;
        }

        .name-shimmer {
            background: linear-gradient(
                110deg, 
                #333 10%, 
                #555 25%, 
                #fff 48%, 
                #fff 52%,
                #888 65%, 
                #444 80%
            );
            background-size: 200% auto;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: mercuryFlash 3s cubic-bezier(0.4, 0, 0.2, 1) infinite;
            display: inline-block;
            white-space: nowrap;
            will-change: background-position, transform;
        }

        @keyframes mercuryFlash {
            0% { background-position: -100% center; transform: skewX(0deg); }
            5% { background-position: -100% center; transform: skewX(-3deg); }
            10% { transform: skewX(3deg); }
            15% { transform: skewX(0deg); }
            100% { background-position: 100% center; }
        }

        /* --- TIGHTENED DUAL ORBIT VORTEX --- */
        .vortex-scene {
            position: relative;
            width: 450px;
            height: 450px;
            display: flex;
            align-items: center;
            justify-content: center;
            perspective: 1500px;
            transform-style: preserve-3d;
            overflow: visible;
        }

        .orbit-system {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transform: rotateX(60deg);
        }

        .orbit-ring-line {
            position: absolute;
            top: 50%; left: 50%;
            border: 1px dashed rgba(255, 255, 255, 0.08);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
        }

        .ring-inner-line { width: 300px; height: 300px; }
        .ring-outer-line { width: 420px; height: 420px; }

        .tech-rune-path {
            position: absolute;
            top: 50%; left: 50%;
            transform-style: preserve-3d;
            animation: runeCircularRotate var(--duration) linear infinite;
        }

        .inner-orbit { width: 300px; height: 300px; margin-top: -150px; margin-left: -150px; }
        .outer-orbit { width: 420px; height: 420px; margin-top: -210px; margin-left: -210px; }

        .tech-rune-stone {
            position: absolute;
            top: 0; left: 50%;
            width: 44px;
            height: 44px;
            background: rgba(5, 7, 12, 0.95);
            border: 1px solid var(--indigo);
            color: var(--indigo);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.85rem;
            font-weight: 900;
            transform: translate(-50%, -50%) rotateX(-60deg);
            box-shadow: 0 0 20px var(--indigo), inset 0 0 10px var(--indigo);
            animation: stoneFloat 4s ease-in-out infinite alternate;
            z-index: 100;
            user-select: none;
        }

        @keyframes runeCircularRotate {
            from { transform: rotateZ(0deg); }
            to { transform: rotateZ(360deg); }
        }

        @keyframes stoneFloat {
            0%, 100% { transform: translate(-50%, -50%) rotateX(-60deg) translateZ(10px); }
            50% { transform: translate(-50%, -50%) rotateX(-60deg) translateZ(-10px); }
        }

        .hero-pfp-vessel {
            position: relative;
            z-index: 10;
            width: 240px;
            height: 240px;
            padding: 5px;
            background: linear-gradient(135deg, rgba(255,255,255,0.15), transparent);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            box-shadow: 0 0 100px rgba(99, 102, 241, 0.15);
            animation: vesselFloat 6s ease-in-out infinite;
            transform: translateZ(20px);
        }

        @keyframes vesselFloat {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-15px) rotate(1deg); }
        }

        /* --- Pipeline & Reveal --- */
        .pipeline-line {
            stroke-dasharray: 10;
            animation: dashMove 35s linear infinite;
        }

        @keyframes dashMove {
            from { stroke-dashoffset: 1000; }
            to { stroke-dashoffset: 0; }
        }

        .grid-blueprint {
            background-size: 50px 50px;
            background-image: 
                linear-gradient(to right, rgba(99, 102, 241, 0.04) 1px, transparent 1px),
                linear-gradient(to bottom, rgba(99, 102, 241, 0.04) 1px, transparent 1px);
        }

        .animate-reveal {
            opacity: 0;
            transform: translateY(25px);
            transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1) 0.8s;
        }

        .animate-reveal.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        #modal {
            transition: opacity 0.3s ease;
            background-color: rgba(2, 4, 6, 0.95);
        }

        .bento-glow {
            position: absolute;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            filter: blur(80px);
            pointer-events: none;
            opacity: 0.12;
            z-index: 0;
            transition: opacity 0.5s ease;
        }

        .glass-card:hover .bento-glow { opacity: 0.25; }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #020406; }
        ::-webkit-scrollbar-thumb { background: #1e293b; border-radius: 10px; }
    </style>
</head>
<body class="antialiased">

    <div class="vignette"></div>

    <!-- Hero Section -->
    <section class="relative min-h-screen flex items-center justify-center px-6 overflow-hidden">
        <div class="absolute top-0 right-0 w-[600px] h-[600px] bg-indigo-600/10 blur-[150px] rounded-full"></div>
        <div class="absolute bottom-0 left-0 w-[600px] h-[600px] bg-sky-600/10 blur-[150px] rounded-full"></div>

        <div class="max-w-7xl mx-auto w-full relative z-10">
            <div class="flex flex-col md:flex-row items-center gap-12 lg:gap-24">
                <div class="flex-1 text-center md:text-left">
                    <div class="inline-flex items-center gap-2 px-3 py-1 mb-8 text-[10px] font-bold tracking-[0.2em] text-emerald-400 uppercase bg-emerald-400/5 border border-emerald-400/20 rounded-md">
                        <span class="w-1.5 h-1.5 bg-emerald-400 rounded-full animate-pulse shadow-[0_0_10px_#34d399]"></span>
                        Status: Available for Commissions
                    </div>

                    <div class="name-container mb-6">
                        <h1 class="text-7xl lg:text-9xl font-black tracking-tighter uppercase leading-[0.9] name-shimmer">Blazinik</h1>
                    </div>

                    <p class="text-lg lg:text-xl text-slate-400 max-w-lg mb-12 leading-relaxed font-light">
                        Specializing in engineering high-fidelity digital environments and intricate simulation systems with a technical edge.
                    </p>

                    <div class="flex flex-col gap-8 items-center md:items-start">
                        <div class="flex flex-wrap justify-center md:justify-start gap-4 items-center">
                            <a href="#portfolio" class="px-8 py-3 bg-white text-dark-base rounded-md font-bold text-xs uppercase tracking-widest hover:scale-105 transition-all shadow-[0_10px_30px_-10px_rgba(255,255,255,0.3)]">
                                View Portfolio
                            </a>
                            <a href="https://steamcommunity.com/profiles/76561199821469314/" target="_blank" class="p-2.5 bg-white/5 border border-white/10 rounded-md text-sky-400 hover:border-sky-400 transition-all">
                                <img src="images/steamicon.png" class="w-6 h-6 object-contain" alt="Steam" onerror="this.style.display='none'">
                                <script>document.querySelector('img').onerror = function() { this.style.display='none'; document.getElementById('steam-fallback').style.display='block'; }</script>
                            </a>
                            <a href="https://www.youtube.com/c/Blazinik" target="_blank" class="p-3 bg-white/5 border border-white/10 rounded-md text-rose-500 hover:border-rose-500 transition-all">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 19a4 4 0 10-4-4A4 4 0 10-8 3c{-2.65 0 -2.65 2.65 -2.65 5a4 4 0 100 7c2.65 0 2.65 -2.65 2.65 -5a4 4 0 100 -7zM3 9l3.3 8-3.3 8"></path></svg>
                            </a>
                        </div>
                        <a href="#contact" class="inline-flex items-center gap-2 text-[10px] uppercase tracking-widest font-bold text-slate-500">Contact Me</a>
                    </div>
                </div>

                <!-- DUAL ORBIT VORTEX CENTERPIECE -->
                <div class="flex-1 flex justify-center items-center relative py-12">
                    <div class="vortex-scene">
                        <div class="orbit-system">
                            <div class="orbit-ring-line ring-inner-line"></div>
                            <div class="orbit-ring-line ring-outer-line"></div>

                            <!-- INNER ORBIT: 3D, </>, Ps -->
                            <div class="tech-rune-path inner-orbit" style="--duration: 8s;">
                                <div class="tech-rune-stone" style="--color: #6366f1; top: 0; left: 50%;">3D</div>
                                <div class="tech-rune-stone" style="--color: #0ea5e9; top: 75%; left: 6.7%;">Ps</div>
                                <div class="tech-rune-stone" style="--color: #f43f5e; top: 75%; left: 93.3%;">&lt;/&gt;</div>
                            </div>

                            <!-- OUTER ORBIT: Ae, UX, FX -->
                            <div class="tech-rune-path outer-orbit" style="--duration: 15s; animation-direction: reverse;">
                                <div class="tech-rune-stone" style="--color: #8b5cf6; top: 0; left: 50%;">Ae</div>
                                <div class="tech-rune-stone" style="--color: #10b981; top: 75%; left: 6.7%;">UX</div>
                                <div class="tech-rune-stone" style="--color: #f97316; top: 75%; left: 93.3%;">FX</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Bento Skillset Section -->
    <section id="expertise" class="py-32 bg-dark-surface/40 border-y border-white/5">
        <div class="max-w-7xl mx-auto px-6 relative z-10">
            <div class="text-center mb-32 animate-reveal">
                <h2 class="text-4xl lg:text-6xl font-black text-white mb-4 uppercase tracking-tighter text-center">My Skillset</h2>
                <div class="w-12 h-1 bg-brand-sky mx-auto rounded-full"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 h-full">
                <!-- 3D Modeling Box -->
                <div class="md:col-span-2 md:row-span-2 glass-card p-10 rounded-xl flex flex-col justify-between group hover:border-indigo-500/40 relative overflow-hidden animate-reveal">
                    <div class="bento-glow top-[-50px] right-[-50px] bg-indigo-500/20"></div>
                    <div class="flex flex-col relative z-10">
                        <div class="flex items-center justify-between mb-6">
                            <span class="text-xs font-mono font-bold text-indigo-400 opacity-50 uppercase tracking-widest">3D Modeling</span>
                            <div class="w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse"></div>
                        </div>
                        <h4 class="text-sm font-black text-white uppercase mb-6 tracking-wider leading-none">Environment Design</h4>
                        <ul class="space-y-4 text-slate-400 text-sm font-light">
                            <li class="flex items-center gap-3 hover:text-emerald-400 transition-colors"><span class="w-1.5 h-1.5 bg-indigo-500 rounded-full"></span> Sci-Fi Environments</li>
                            <li class="flex items-center gap-3 hover:text-emerald-400 transition-colors"><span class="w-1.5 h-1.5 bg-indigo-500 rounded-full"></span> Medieval Castles</li>
                            <li class="flex items-center gap-3 hover:text-emerald-400 transition-colors"><span class="w-1.5 h-1.5 bg-indigo-500 rounded-full"></span> Modern Architecture</li>
                            <li class="flex items-center gap-3 hover:text-emerald-400 transition-colors"><span class="w-1.5 h-1.5 bg-indigo-500 rounded-full"></span> Modular Building Systems</li>
                        </ul>
                    </div>
                    <div class="font-mono text-[10px] text-slate-600 mt-10 tracking-widest uppercase flex items-center gap-2">
                        <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span> Production Ready
                    </div>
                </div>

                <!-- Software Engineering -->
                <div class="md:col-span-2 glass-card p-8 rounded-xl group hover:border-emerald-500/40 relative overflow-hidden animate-reveal" style="transition-delay: 150ms;">
                    <div class="bento-glow bottom-[-50px] left-[-50px] bg-emerald-500/20"></div>
                    <div class="flex flex-col relative z-10">
                        <div class="flex items-center justify-between mb-4 text-[10px] font-mono font-bold text-emerald-400 opacity-50 uppercase tracking-widest">Software Engineering</div>
                        <h4 class="text-sm font-black text-white uppercase tracking-wider mb-2">System Design</h4>
                        <p class="text-slate-500 text-[11px] font-light leading-relaxed">Building scalable backend systems and reactive frontends.</p>
                    </div>
                </div>

                <!-- Lua / Gameplay -->
                <div class="glass-card p-8 rounded-xl group hover:border-rose-500/40 relative overflow-hidden animate-reveal" style="transition-delay: 250ms;">
                    <div class="w-12 h-12 bg-rose-500/10 text-rose-500 rounded-xl flex items-center justify-center mb-4 border border-rose-500/10 group-hover:scale-95 transition-transform">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 19a4 4 0 10-4-4A4 4 0 10-8 3c{-2.65 0 -2.65 2.65 -2.65 5a4 4 0 100 7c2.65 0 2.65 -2.65 2.65 -5a4 4 0 100 -7zM3 9l3.3 8-3.3 8"></path></svg>
                    </div>
                    <h4 class="text-lg font-black text-white uppercase mb-2">Gameplay Logic</h4>
                    <p class="text-slate-500 text-[10px] font-mono leading-relaxed">Creating procedural missions and complex simulation systems.</p>
                </div>

                <!-- Product Design -->
                <div class="glass-card p-8 rounded-xl group hover:border-sky-500/40 relative overflow-hidden animate-reveal" style="transition-delay: 350ms;">
                    <div class="w-12 h-12 bg-sky-500/10 text-sky-400 rounded-xl flex items-center justify-center mb-4 border border-sky-500/10 group-hover:scale-110 transition-transform">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9l3.3 8-3.3 8"></path></svg>
                    </div>
                    <h4 class="text-lg font-black text-white uppercase mb-2">UI/UX Design</h4>
                    <p class="text-slate-500 text-[10px] font-mono leading-relaxed">Designing intuitive interfaces and modular brand identity systems.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Project Archive -->
    <section id="portfolio" class="py-32 bg-dark-base">
        <div class="max-w-7xl mx-auto px-6">
            <h2 class="text-4xl lg:text-5xl font-black text-white mb-16 uppercase tracking-tighter text-center animate-reveal">Project Archive</h2>

            <div id="showcase" class="glass-card rounded-3xl overflow-hidden animate-reveal group shadow-2xl">
                <div class="flex flex-col lg:flex-row min-h-[500px]">
                    <div class="lg:w-3/5 relative bg-black flex items-center justify-center overflow-hidden border-b lg:border-b-0 lg:border-r border-white/5 cursor-zoom-in">
                        <img id="sc-img" src="images/brokiecasino1.png" class="w-full h-full object-cover rounded-full" alt="Showcase">
                        <div class="absolute inset-x-0 bottom-8 flex justify-center gap-4 z-20">
                            <button id="prev" class="p-3 bg-white/10 hover:bg-white/20 backdrop-blur-xl rounded-full text-white transition-all disabled:opacity-20">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                            </button>
                            <div class="px-5 py-2.5 bg-white/10 backdrop-blur-xl font-mono text-white rounded-full flex items-center text-[10px] tracking-widest" id="sc-counter">01 / 04</div>
                            <button id="next" class="p-3 bg-white/10 hover:bg-white/20 backdrop-blur-xl rounded-full text-white transition-all disabled:opacity-20">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                            </button>
                        </div>
                    </div>
                    <div class="lg:w-2/5 p-10 lg:p-14 flex flex-col relative justify-center bg-dark-surface/50">
                        <h3 id="sc-title" class="text-3xl font-black text-white mb-6 tracking-tight uppercase leading-none">Loading...</h3>
                        <p id="sc-desc" class="text-slate-400 leading-relaxed mb-10 flex-grow font-light text-sm">Processing data...</p>
                        <div id="sc-tags" class="flex flex-wrap gap-2 mt-8"></div>
                        <a id="sc-link" href="#" target="_blank" class="px-8 py-4 bg-white text-dark-base rounded-md font-bold text-[10px] uppercase tracking-widest text-center">Launch Build</a>
                    </div>
                </div>
            </div>
            <div id="thumb-grid" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4 mt-8 animate-reveal"></div>
        </div>
    </section>

    <!-- Pipeline Process -->
    <section id="workflow" class="py-40 relative overflow-hidden grid-blueprint bg-dark-base border-t border-white/5">
        <svg class="absolute inset-0 w-full h-full opacity-20 pointer-events-none hidden lg:block" viewBox="0 0 1440 600" preserveAspectRatio="none">
            <path class="pipeline-line" d="M -50 300 C 300 100, 600 500, 800 300 S 1200 100, 1500 300" stroke="#6366f1" stroke-width="2" stroke-dasharray="14 14" fill="none" />
            <circle cx="280" cy="225" r="3" fill="#6366f1" />
            <circle cx="600" cy="410" r="3" fill="#0ea5e9" />
            <circle cx="950" cy="205" r="3" fill="#6366f1" />
            <circle cx="1250" cy="385" r="3" fill="#0ea5e9" />
        </svg>

        <div class="max-w-7xl mx-auto px-6 relative z-10">
            <div class="text-center mb-32 animate-reveal">
                <h2 class="text-4xl lg:text-6xl font-black text-white mb-4 uppercase tracking-tighter text-center">The Process</h2>
                <div class="w-12 h-1 bg-brand-sky mx-auto rounded-full"></div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                <div class="animate-reveal group relative lg:-top-12" style="transition-delay: 100ms;">
                    <div class="glass-card p-6 rounded-xl border-l-2 border-brand-indigo hover:bg-white/5 transition-all max-w-[260px] mx-auto">
                        <div class="flex items-center justify-between mb-4">
                            <span class="text-xs font-mono font-bold text-indigo-400 opacity-50 uppercase tracking-widest">01 / Insight</span>
                            <div class="w-1.5 h-1.5 bg-indigo-500 rounded-full animate-pulse"></div>
                        </div>
                        <h4 class="text-sm font-black text-white uppercase mb-6 tracking-wider leading-none">Project Vision</h4>
                        <p class="text-slate-500 text-[11px] font-light leading-relaxed">We sit down to talk about your project, your aesthetic likes, and your functional goals.</p>
                    </div>
                </div>
                <div class="animate-reveal group relative lg:top-20" style="transition-delay: 200ms;">
                    <div class="glass-card p-6 rounded-xl border-l-2 border-brand-sky hover:bg-white/5 transition-all max-w-[260px] mx-auto">
                        <div class="flex items-center justify-between mb-4 text-[10px] font-mono font-bold text-sky-400 opacity-50 uppercase tracking-widest">02 / Drafting</div>
                        <h4 class="text-sm font-black text-white uppercase tracking-wider mb-2">Technical Schematic</h4>
                        <p class="text-slate-500 text-[11px] font-light leading-relaxed">I forge the structural drafts and 3D wireframes to ensure the design direction is locked in.</p>
                    </div>
                </div>
                <div class="animate-reveal group relative lg:-top-6" style="transition-delay: 300ms;">
                    <div class="glass-card p-6 rounded-xl border-l-2 border-brand-indigo hover:bg-white/5 transition-all max-w-[260px] mx-auto">
                        <div class="flex items-center justify-between mb-4 text-[10px] font-mono font-bold text-indigo-400 opacity-50 uppercase tracking-widest">03 / Building</div>
                        <h4 class="text-sm font-black text-white uppercase tracking-wider mb-2">Digital Synthesis</h4>
                        <p class="text-slate-500 text-[11px] font-light leading-relaxed">The technical build phase where I write clean code and craft precision assets for the environment.</p>
                    </div>
                </div>
                <div class="animate-reveal group relative lg:top-12" style="transition-delay: 400ms;">
                    <div class="glass-card p-6 rounded-xl border-l-2 border-brand-sky hover:bg-white/5 transition-all max-w-[260px] mx-auto">
                        <div class="flex items-center justify-between mb-4 text-[10px] font-mono font-bold text-sky-400 opacity-50 uppercase tracking-widest">04 / Release</div>
                        <h4 class="text-sm font-black text-white uppercase tracking-wider mb-2">Final Unveiling</h4>
                        <p class="text-slate-500 text-[11px] font-light leading-relaxed">Rigorous optimization and deployment, ensuring everything runs perfectly post-launch.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CONTACT SECTION -->
    <section id="contact" class="py-10 bg-dark-base border-t border-white/5 relative overflow-hidden">
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full max-w-2xl bg-indigo-600/5 blur-[100px] rounded-full pointer-events-none"></div>

        <div class="max-w-7xl mx-auto px-6 relative z-10 text-center">
            <div class="animate-reveal mb-6">
                <h2 class="text-4xl lg:text-5xl font-black text-white mb-2 uppercase tracking-tighter text-center">Connect</h2>
                <p class="text-slate-400 text-sm max-w-md mx-auto font-light">Reach out via Discord or Email to start the forge.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 items-stretch">
                <!-- Discord -->
                <div class="glass-card p-6 rounded-2xl animate-reveal group text-left relative overflow-hidden flex flex-col justify-between" style="transition-delay: 100ms;">
                    <div class="bento-glow top-[-50px] right-[-50px] bg-indigo-500/20"></div>
                    <div>
                        <div class="w-10 h-10 bg-indigo-500/10 text-indigo-400 rounded-xl flex items-center justify-center mb-4 border border-indigo-500/20 group-hover:scale-110 transition-transform">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                        </div>
                        <h4 class="text-lg font-black text-white uppercase mb-1">Discord</h4>
                        <p class="text-slate-500 text-[10px] font-mono leading-relaxed">Blazinik</p>
                    </div>
                    <button id="discord-btn" class="w-full py-2.5 bg-indigo-600/10 border border-indigo-600/20 rounded-lg text-indigo-400 font-bold text-[9px] uppercase tracking-widest hover:bg-indigo-600 hover:text-white transition-all">
                        Copy Username
                    </button>
                </div>

                <!-- Email -->
                <div class="glass-card p-6 rounded-2xl animate-reveal group text-left relative overflow-hidden flex flex-col justify-between" style="transition-delay: 200ms;">
                    <div class="bento-glow bottom-[-50px] left-[-50px] bg-sky-500/20"></div>
                    <div>
                        <div class="w-10 h-10 bg-sky-500/10 text-sky-400 rounded-xl flex items-center justify-center mb-4 border border-sky-500/10 group-hover:scale-110 transition-transform">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9l3.3 8-3.3 8"></path></svg>
                        </div>
                        <h4 class="text-lg font-black text-white uppercase mb-1">Email</h4>
                        <p class="text-slate-500 text-[10px] font-mono leading-relaxed">blazinik@outlook.com</p>
                    </div>
                    <div class="flex justify-start pb-1">
                        <button id="email-btn" class="flex-1 py-2.5 bg-sky-600/10 border border-sky-600/20 rounded-lg text-sky-400 font-bold text-[9px] uppercase tracking-widest hover:bg-sky-600 hover:text-white transition-all">
                            Copy Address
                        </button>
                        <a href="mailto:blazinik@outlook.com" class="p-2.5 bg-white/5 border border-white/10 rounded-lg text-white hover:bg-white hover:text-dark-base transition-all flex items-center justify-center">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9l3.3 8-3.3 8"></path></svg>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-20 bg-black border-t border-white/5">
        <div class="max-w-7xl mx-auto px-6 text-center">
            <p class="text-slate-600 font-mono text-[9px] uppercase tracking-[0.5em] mb-10">
                Precision Hand-Crafted by <span class="text-white">Blazinik</span> â€” 2024
            </p>
            <div class="flex justify-center gap-12 text-[10px] font-black tracking-widest uppercase text-slate-500">
                <a href="https://steamcommunity.com/profiles/76561199821469314/" target="_blank" class="hover:text-white transition-all">Steam</a>
                <a href="https://www.youtube.com/c/Blazinik" target="_blank" class="hover:text-white transition-all">YouTube</a>
                <a href="#contact" class="hover:text-white transition-all">Contact</a>
            </div>
        </div>
    </footer>

    <div id="modal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 z-50 hidden">
        <div class="modal-content w-full max-w-sm p-6 rounded-2xl shadow-lg max-h-[90vh] flex flex-col">
            <h3 id="modalTitle" class="text-xl font-semibold mb-4 flex-shrink-0">Add New Item</h3>
            <div class="flex-grow overflow-y-auto -mr-2 pr-2">
                <form id="eventForm">
                    <input type="hidden" id="eventId">
                    <div>
                        <label for="eventTitle" class="block text-sm font-medium text-text-secondary mb-1">Title</label>
                        <input type="text" id="eventTitle" name="eventTitle" class="form-input w-full rounded-lg px-3 py-2" required>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label for="eventStartDate" class="block text-sm font-medium text-text-secondary mb-1">Start Date</label>
                            <input type="date" id="eventStartDate" name="eventStartDate" class="form-input w-full rounded-lg px-3 py-2" required>
                        </div>
                        <div>
                            <label for="eventEndDate" class="block text-sm font-medium text-text-secondary mb-1">End Date (optional)</label>
                            <input type="date" id="eventEndDate" name="eventEndDate" class="form-input w-full rounded-lg px-3 py-2">
                        </div>
                    </div>

                    <div class="mt-4">
                        <label for="eventType" class="block text-sm font-medium text-text-secondary mb-1">Type</label>
                        <select id="eventType" name="eventType" class="form-input w-full rounded-lg px-3 py-2">
                            <option value="event">Event</option><option value="bill">Bill</option>
                        </select>
                    </div>

                    <div class="mt-4">
                        <label for="eventDescription" class="block text-sm font-medium text-text-secondary mb-1">Description (optional)</label>
                        <textarea id="eventDescription" name="eventDescription" rows="2" class="form-input w-full rounded-lg px-3 py-2"></textarea>
                    </div>

                    <div class="mt-4">
                        <label class="block text-sm font-medium text-text-secondary mb-1">Icon</label>
                        <input type="hidden" id="eventEmoji"><div id="emojiPicker" class="emoji-picker"></div>
                    </div>

                    <div class="mt-4">
                        <label class="block text-sm font-medium text-text-secondary mb-1">Color</label>
                        <input type="hidden" id="eventColor"><div id="colorPicker" class="color-picker"></div>
                    </div>

                    <div class="mt-4 grid grid-cols-2 gap-4 items-end">
                        <div>
                            <label for="eventRecurring" class="block text-sm font-medium text-text-secondary mb-1">Frequency</label>
                            <select id="eventRecurring" name="eventRecurring" class="form-input w-full rounded-lg px-3 py-2">
                                <option value="none">None</option>
                                <option value="weekly">Weekly</option>
                                <option value="biweekly">Biweekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="yearly">Yearly</option>
                            </select>
                        </div>
                        <div class="flex justify-start pb-1">
                            <label class="flex items-center cursor-pointer">
                                <input type="checkbox" id="eventCountdown" name="eventCountdown" class="form-checkbox h-5 w-5 text-accent-primary bg-bg-tertiary border-gray-600 rounded">
                                <span class="ml-2 text-text-primary">Set as Countdown</span>
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="flex justify-end gap-3 mt-6 pt-4 border-t border-gray-800 flex-shrink-0">
                <button type="button" id="deleteEventBtn" class="btn btn-danger hidden">Delete</button>
                <button type="button" id="cancelBtn" class="btn btn-secondary">Cancel</button>
                <button type="submit" form="eventForm" class="btn btn-accent">Save</button>
            </div>
        </div>
    </div>
     <div id="detailsModal" class="modal-backdrop fixed inset-0 flex items-center justify-center p-4 z-50 hidden">
        <div class="modal-content w-full max-w-md p-6 rounded-2xl shadow-lg">
            <div class="flex justify-between items-start">
                <div><h3 id="detailsDate" class="text-xl font-semibold mb-1"></h3><p id="detailsDay" class="text-text-secondary"></p></div>
                <button id="detailsCloseBtn" class="p-1 -mt-2 -mr-2 rounded-full hover:bg-gray-700 transition-colors"><svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button>
            </div>
            <div id="detailsContent" class="mt-4 space-y-3 max-h-64 overflow-y-auto pr-2"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let currentYear = new Date().getFullYear();
            let currentMonth = new Date().getMonth();
            let events = JSON.parse(localStorage.getItem('calendarEvents-v2')) || [];
            let currentView = 'year';

            // DOM Elements
            const yearView = document.getElementById('yearView');
            const monthView = document.getElementById('monthView');
            const viewTitle = document.getElementById('viewTitle');
            const viewToggleBtn = document.getElementById('viewToggleBtn');
            const calendarGrid = document.getElementById('calendarGrid');
            const monthYearHeader = document.getElementById('monthYearHeader');
            const prevMonthBtn = document.getElementById('prevMonthBtn');
            const nextMonthBtn = document.getElementById('nextMonthBtn');
            const todayBtn = document.getElementById('todayBtn');
            const countdownContainer = document.getElementById('countdownContainer');
            const prevYearBtn = document.getElementById('prevYearBtn');
            const nextYearBtn = document.getElementById('nextYearBtn');

            // Modal Elements
            const eventModal = document.getElementById('eventModal');
            const modalTitle = document.getElementById('modalTitle');
            const eventForm = document.getElementById('eventForm');
            const eventStartDateInput = document.getElementById('eventStartDate');
            const eventEndDateInput = document.getElementById('eventEndDate');
            const eventIdInput = document.getElementById('eventId');
            const eventTitleInput = document.getElementById('eventTitle');
            const eventTypeInput = document.getElementById('eventType');
            const eventDescriptionInput = document.getElementById('eventDescription');
            const eventRecurringSelect = document.getElementById('eventRecurring');
            const eventCountdownCheckbox = document.getElementById('eventCountdown');
            const cancelBtn = document.getElementById('cancelBtn');
            const deleteEventBtn = document.getElementById('deleteEventBtn');
            const emojiPicker = document.getElementById('emojiPicker');
            const eventEmojiInput = document.getElementById('eventEmoji');
            const colorPicker = document.getElementById('colorPicker');
            const eventColorInput = document.getElementById('eventColor');
            const detailsModal = document.getElementById('detailsModal');
            const detailsDate = document.getElementById('detailsDate');
            const detailsDay = document.getElementById('detailsDay');
            const detailsContent = document.getElementById('detailsContent');
            const detailsCloseBtn = document.getElementById('detailsCloseBtn');

            const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            const dayNames = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            const dayNamesShort = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
            const emojis = ['ðŸ“±', 'ðŸ’¼', 'ðŸŽ‚', 'âœˆï¸', 'â¤ï¸', 'ðŸ’°', 'ðŸ’³', 'ðŸ¡', 'ðŸ’ª', 'ðŸ½ï¸', 'ðŸŽ“', 'ðŸ©º', 'ðŸš—', 'ðŸ›œ'];
            const eventColors = ['#3B82F6', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6', '#EC4899'];

            const holidayIcons = { "new year": 'ðŸ¥³', "valentine": 'â¤ï¸', "patrick": 'ðŸ€', "easter": 'ðŸ°', "mother": 'ðŸ‘©â€ðŸ‘§â€ðŸ‘¦', "father": 'ðŸ‘¨â€ðŸ‘§â€ðŸ‘¦', "juneteenth": 'âœŠðŸ¿', "independence": 'ðŸŽ†', "halloween": 'ðŸŽƒ', "thanksgiving": 'ðŸ¦ƒ', "christmas": 'ðŸŽ„', "king": 'ðŸ•Šï¸' };
            const holidays = { '01-01': "New Year's Day", '01-20': "Martin Luther King, Jr. Day", '02-14': "Valentine's Day", '02-17': "Presidents' Day", '03-17': "St. Patrick's Day", '04-18': "Good Friday", '04-20': "Easter Sunday", '05-11': "Mother's Day", '05-26': "Memorial Day", '06-15': "Father's Day", '06-19': "Juneteenth", '07-04': "Independence Day", '09-01': "Labor Day", '10-13': "Columbus Day", '10-31': "Halloween", '11-11': "Veterans Day", '11-27': "Thanksgiving Day", '12-25': "Christmas Day" };

            function getHolidayIcon(title) {
                const lowerTitle = title.toLowerCase();
                for (const key in holidayIcons) if (lowerTitle.includes(key)) return holidayIcons[key];
                return 'â­';
            }

            const getISODate = (date) => date.toISOString().split('T')[0];

            function generateYearView() {
                yearView.innerHTML = '';
                const seasons = { winter: [11, 0, 1], spring: [2, 3, 4], summer: [5, 6, 7], autumn: [8, 9, 10] };
                const seasonInfo = { winter: 'â„ï¸ Winter', spring: 'ðŸŒ¸ Spring', summer: 'â˜€ï¸ Summer', autumn: 'ðŸ‚ Autumn' };
                const todayString = new Date().toDateString();

                monthNames.forEach((name, index) => {
                    let seasonKey = Object.keys(seasons).find(key => seasons[key].includes(index));
                    let seasonDisplay = seasonInfo[seasonKey];
                    let seasonClass = `month-card-${seasonKey}`;

                    const monthCard = `<div class="month-card p-4 rounded-xl cursor-pointer border border-transparent ${seasonClass}" data-month="${index}" style="animation-delay: ${index * 0.05}s;">
                        <div class="flex justify-between items-center mb-2">
                             <h3 class="font-bold text-lg text-accent-primary">${name}</h3>
                             <span class="text-sm font-medium text-text-secondary">${seasonDisplay}</span>
                        </div>
                        <div class="grid grid-cols-7 gap-1 text-xs text-center text-text-secondary">
                            ${dayNamesShort.map(d => `<div>${d[0]}</div>`).join('')}
                            ${Array.from({ length: new Date(currentYear, index, 1).getDay() }).fill('<div></div>').join('')}
                            ${Array.from({ length: new Date(currentYear, index + 1, 0).getDate() }, (_, i) => {
                                const day = i + 1;
                                const date = new Date(currentYear, index, day);
                                const isToday = date.toDateString() === todayString;
                                return `<div class="w-5 h-5 flex items-center justify-center mx-auto ${isToday ? 'today-highlight-year' : ''}">${day}</div>`;
                            }).join('')}
                        </div>
                    </div>`;
                    yearView.insertAdjacentHTML('beforeend', monthCard);
                });
                yearView.querySelectorAll('.month-card').forEach(card => {
                    card.addEventListener('click', () => {
                        currentMonth = parseInt(card.dataset.month);
                        switchToMonthView();
                    });
                });
            }

            function generateMonthView() {
                calendarGrid.innerHTML = dayNamesShort.map(day => `<div class="text-center font-semibold text-text-secondary text-sm py-2">${day}</div>`).join('');
                monthYearHeader.textContent = `${monthNames[currentMonth]} ${currentYear}`;

                const firstDayOfMonth = new Date(currentYear, currentMonth, 1).getDay();
                const gridStartDate = new Date(currentYear, currentMonth, 1);
                const gridEndDate = new Date(gridStartDate);
                gridEndDate.setDate(gridStartDate.getDate() + 41);

                // 1. Add all base events (recurring or not) that overlap with the grid view
                events.forEach(event => {
                    const eventStart = new Date(`${event.date}T12:00:00`);
                    const eventEnd = event.endDate ? new Date(`${event.endDate}T12:00:00`) : eventStart;
                    if (eventStart <= gridEndDate && eventEnd >= gridStartDate) {
                        calendarGrid.innerHTML += `<div class="day-cell-wrapper">
                                <div class="day-cell flex flex-col p-2 rounded-lg cursor-pointer ${event.date === new Date().toDateString() ? 'today-highlight' : ''}">${event.title}</div>
                            </div>`;
                    }
                });

                // 2. Generate recurring instances and holidays for the entire grid view
                for (let i = 0; i < 42; i++) {
                    const currentDate = new Date(gridStartDate);
                    currentDate.setDate(gridStartDate.getDate() + i);
                    const isoDate = getISODate(currentDate);

                    // Handle recurring events
                    events.forEach(event => {
                        if (event.recurring && event.recurring !== 'none') {
                            if (isoDate > event.date && checkRecurring(event, currentDate)) {
                                const instanceId = `${event.id}-${isoDate}`;
                                if (!uniqueEvents.has(instanceId)) {
                                     const newEndDate = event.endDate ? getISODate(new Date(currentDate.getTime() + (new Date(event.endDate) - new Date(event.date)))) : null;
                                     uniqueEvents.set(instanceId, {
                                        ...event,
                                        id: instanceId,
                                        date: isoDate,
                                        endDate: newEndDate,
                                        isRecurringInstance: true
                                    });
                                }
                            }
                        }
                    });

                    // Handle holidays
                    const monthDay = isoDate.substring(5);
                    if (holidays[monthDay]) {
                        const holidayId = `holiday-${isoDate}`;
                        if (!uniqueEvents.has(holidayId)) {
                            uniqueEvents.set(holidayId, {
                                id: holidayId,
                                date: isoDate,
                                title: holidays[monthDay],
                                type: 'holiday',
                                color: '#10B981'
                            });
                        }
                    }
                }

                calendarGrid.querySelectorAll('.day-cell').forEach(cell => {
                    cell.addEventListener('click', () => openDetailsModal(cell.dataset.date));
                    cell.querySelector('.add-day-event-btn').addEventListener('click', (e) => e.stopPropagation());
                });
            }

            function renderEventBars(firstDayOfMonth, daysInMonth) {
                const eventBarsContainer = document.getElementById('event-bars-container');
                if (!eventBarsContainer) return;
                eventBarsContainer.innerHTML = '';
                const monthEvents = getEventsForMonth(currentYear, currentMonth);

                const layout = []; // This will be indexed 0-41
                // Define the start date of the 42-day grid view
                const gridViewStartDate = new Date(currentYear, currentMonth, 1);
                const startOfGridView = new Date(`${getISODate(gridViewStartDate)}T12:00:00`);

                monthEvents.forEach(event => {
                    const eventStartDate = new Date(`${event.date}T12:00:00`);
                    const eventEndDate = event.endDate ? new Date(`${event.endDate}T12:00:00`) : eventStartDate;

                    // Calculate day index relative to the start of the grid (0-41)
                    const startIndex = (eventStartDate - startOfGridView) / (1000 * 60 * 60 * 24);
                    const endIndex = (eventEndDate - startOfGridView) / (1000 * 60 * 60 * 24);

                    // Only render events that are at all visible in the 42-day grid
                    if (endIndex < 0 || startIndex > 41) return;

                    const effectiveStartIndex = Math.max(0, startIndex);
                    const effectiveEndIndex = Math.min(41, endIndex);

                    // Find the first available vertical track for this event
                    let track = 0;
                    while (true) {
                        let collision = false;
                        for (let i = effectiveStartIndex; i <= effectiveEndIndex; i++) {
                            if (layout[i] && layout[i][track]) {
                                collision = true;
                                break;
                            }
                        }
                        if (!collision) break;
                        track++;
                    }

                    // Mark the track as occupied for the duration of the event
                    for (let i = effectiveStartIndex; i <= effectiveEndIndex; i++) {
                        if (!layout[i]) layout[i] = [];
                        layout[i][track] = true;
                    }

                    const dayCellHeight = calendarGrid.querySelector('.day-cell-wrapper')?.offsetHeight || 110;

                    // Render the event bar, splitting it by week if it spans multiple weeks
                    let currentRenderIndex = effectiveStartIndex;
                    while (currentRenderIndex <= effectiveEndIndex) {
                        const weekRow = Math.floor(currentRenderIndex / 7);
                        const startColumn = currentRenderIndex % 7;

                        let segmentEndIndex = currentRenderIndex;
                        while (segmentEndIndex + 1 <= effectiveEndIndex && Math.floor((segmentEndIndex + 1) / 7) === weekRow) {
                            segmentEndIndex++;
                        }

                        const durationInDays = segmentEndIndex - currentRenderIndex + 1;

                        const bar = document.createElement('div');
                        bar.className = 'event-bar';
                        bar.style.top = `${weekRow * dayCellHeight + 30 + track * 28}px`;
                        bar.style.left = `calc(${startColumn / 7 * 100}% + 4px)`;
                        bar.style.width = `calc(${durationInDays / 7 * 100}% - 8px)`;
                        bar.style.backgroundColor = event.color || '#3B82F6';
                        bar.dataset.eventId = event.id.toString().startsWith('holiday-') ? event.id : event.id.split('-')[0];
                        bar.addEventListener('click', (e) => {
                            e.stopPropagation();
                            openDetailsModal(event.date);
                        });

                        const icon = (event.type === 'holiday') ? getHolidayIcon(event.title) : (event.emoji || (event.type === 'bill' ? 'ðŸ’°' : 'ðŸŽ‰'));
                        bar.innerHTML = `<span>${icon}</span><span class="truncate">${event.title}</span>`;
                        eventBarsContainer.appendChild(bar);

                        currentRenderIndex = segmentEndIndex + 1;
                    }
                });
            }

            function checkRecurring(event, currentDate) {
                const eventDate = new Date(`${event.date}T12:00:00`);
                if (currentDate < eventDate) return false;

                switch (event.recurring) {
                    case 'weekly':
                        return currentDate.getDay() === eventDate.getDay();
                    case 'biweekly':
                        const diffTime = Math.abs(currentDate - eventDate);
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                        return currentDate.getDay() === eventDate.getDay() && Math.floor(diffDays / 7) % 2 === 0;
                    case 'monthly':
                    case true:
                        return currentDate.getDate() === eventDate.getDate();
                    case 'yearly':
                        return currentDate.getMonth() === eventDate.getMonth() && currentDate.getDate() === eventDate.getDate();
                }
                return false;
            }

            function getEventsForMonth(year, month) {
                const uniqueEvents = new Map();

                const firstDayOfMonth = new Date(year, month, 1).getDay();
                const gridStartDate = new Date(year, month, 1);
                const gridEndDate = new Date(gridStartDate);
                gridEndDate.setDate(gridStartDate.getDate() + 41);

                // 1. Add all base events (recurring or not) that overlap with the grid view
                events.forEach(event => {
                    const eventStart = new Date(`${event.date}T12:00:00`);
                    const eventEnd = event.endDate ? new Date(`${event.endDate}T12:00:00`) : eventStart;
                    if (eventStart <= gridEndDate && eventEnd >= gridStartDate) {
                        uniqueEvents.set(event.id, event);
                    }
                });

                // 2. Generate recurring instances and holidays for the entire grid view
                for (let i = 0; i < 42; i++) {
                    const currentDate = new Date(gridStartDate);
                    currentDate.setDate(gridStartDate.getDate() + i);
                    const isoDate = getISODate(currentDate);

                    // Handle recurring events
                    events.forEach(event => {
                        if (event.recurring && event.recurring !== 'none') {
                            if (isoDate > event.date && checkRecurring(event, currentDate)) {
                                const instanceId = `${event.id}-${isoDate}`;
                                if (!uniqueEvents.has(instanceId)) {
                                     const newEndDate = event.endDate ? getISODate(new Date(currentDate.getTime() + (new Date(event.endDate) - new Date(event.date)))) : null;
                                     uniqueEvents.set(instanceId, {
                                        ...event,
                                        id: instanceId,
                                        date: isoDate,
                                        endDate: newEndDate,
                                        isRecurringInstance: true
                                    });
                                }
                            }
                        }
                    });

                    // Handle holidays
                    const monthDay = isoDate.substring(5);
                    if (holidays[monthDay]) {
                        const holidayId = `holiday-${isoDate}`;
                        if (!uniqueEvents.has(holidayId)) {
                            uniqueEvents.set(holidayId, {
                                id: holidayId,
                                date: isoDate,
                                title: holidays[monthDay],
                                type: 'holiday',
                                color: '#10B981'
                            });
                        }
                    }
                }

                const monthEvents = Array.from(uniqueEvents.values());
                return monthEvents.sort((a,b) => a.type === 'holiday' ? -1 : 1);
            }

            function getEventsForDate(isoDate) {
                let dayEvents = [];
                const currentDate = new Date(`${isoDate}T12:00:00`);

                events.forEach(event => {
                       const eventStart = new Date(`${event.date}T12:00:00`);
                    const eventEnd = event.endDate ? new Date(`${event.endDate}T12:00:00`) : eventStart;
                    if (currentDate >= eventStart && currentDate <= eventEnd) {
                        dayEvents.push(event);
                    }
                });

                const recurringEvents = events.filter(e => e.recurring && e.recurring !== 'none');
                recurringEvents.forEach(event => {
                    if (event.date !== isoDate && checkRecurring(event, currentDate)) {
                        dayEvents.push({ ...event, date: isoDate, isRecurringInstance: true });
                    }
                });

                const monthDay = isoDate.substring(5);
                if (holidays[monthDay]) dayEvents.unshift({ id: `holiday-${isoDate}`, date: isoDate, title: holidays[monthDay], type: 'holiday', color: '#10B981' });
                return dayEvents;
            }

            // Event Listeners
            viewToggleBtn.addEventListener('click', () => currentView === 'year' ? switchToMonthView() : switchToYearView());
            prevMonthBtn.addEventListener('click', () => { currentMonth = (currentMonth - 1 + 12) % 12; if (currentMonth === 11) currentYear--; updateViewTitle(); generateMonthView(); });
            nextMonthBtn.addEventListener('click', () => { currentMonth = (currentMonth + 1) % 12; if (currentMonth === 0) currentYear++; updateViewTitle(); generateMonthView(); });
            todayBtn.addEventListener('click', () => { currentYear = new Date().getFullYear(); currentMonth = new Date().getMonth(); switchToMonthView(); });

            prevYearBtn.addEventListener('click', () => { currentYear--; updateViewTitle(); generateYearView(); });
            nextYearBtn.addEventListener('click', () => { currentYear++; updateViewTitle(); generateYearView(); });

            monthView.addEventListener('wheel', (e) => {
                e.preventDefault();
                if (isWheeling) return;
                isWheeling = true;

                if (e.deltaY < 0) { // Scrolling Up -> Previous Month
                    prevMonthBtn.click();
                } else { // Scrolling Down -> Next Month
                    nextMonthBtn.click();
                }

                setTimeout(() => { isWheeling = false; }, 200);
            });

            eventForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const startDate = eventStartDateInput.value;
                const endDate = eventEndDateInput.value;

                if (endDate && endDate < startDate) {
                    alert("End date cannot be before the start date.");
                    return;
                }

                const eventData = { title: eventTitleInput.value, type: eventTypeInput.value, date: startDate, endDate: endDate || null, description: eventDescriptionInput.value, recurring: eventRecurringSelect.value, isCountdown: eventCountdownCheckbox.checked, emoji: eventEmojiInput.value, color: eventColorInput.value };
                if (eventIdInput.value) { events = events.map(event => event.id === eventData.id ? { ...event, ...eventData } : event); } else { events.push(eventData); }
                saveEvents(); closeModal(eventModal); updateView();
            });
            cancelBtn.addEventListener('click', () => closeModal(eventModal));
            deleteEventBtn.addEventListener('click', () => { events = events.filter(event => event.id !== eventIdInput.value); saveEvents(); closeModal(eventModal); updateView(); });

            detailsCloseBtn.addEventListener('click', () => closeModal(detailsModal));
            detailsModal.addEventListener('click', (e) => e.target === detailsModal && closeModal(detailsModal));

            // Initial Load
            initPickers();
            currentYear = new Date().getFullYear();
            currentMonth = new Date().getMonth();
            switchToMonthView();
        });
    </script>
</body>
</html>
